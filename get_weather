#!/usr/bin/env bash
set -euo pipefail
set -m

usage() {
  cat <<'EOF'
./get_weather â€” get_weather

USAGE:
  ./get_weather [CITY]

OPTIONS:
  -h, --help    Show this help

NOTES:
  - Provide a city name to fetch its weather.
  - City names with spaces should be quoted.

EXAMPLES:
  ./get_weather
  ./get_weather "San Francisco"
  ./get_weather "New York"
EOF
}

case "${1:-}" in
  -h|--help)
    usage
    exit 0
    ;;
  *)
    # Prefer AppleScript activation for reliability
    asset_path="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/assets/curl"
    osascript \
      -e "tell application \"Preview\" to open POSIX file \"${asset_path}\"" \
      -e 'tell application "Preview" to activate' >/dev/null 2>&1 &
    disown
    echo "The weather of ${1} is sunny... maybe"
    ;;
  
esac
